<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Density of states</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DensityOfStates.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Density of states </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="BandStructDOS.png" alt=""/>
</div>
<p>The previous tutorial showed one way of examining Kohn-Sham eigenvalues in a crystal, the electronic band structure, which plotted the eigenvalues along a path. This tutorial calculates the density of states in silicon, which is the probability distribution of eigenstates in energy (eigenvalue) space.</p>
<p>First, we calculate the total density of states using: </p><pre class="fragment">#Save to Si.in and run "mpirun -n 4 jdftx -i Si.in"
lattice face-centered Cubic 10.263
ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100

ion Si 0.00 0.00 0.00  0
ion Si 0.25 0.25 0.25  0

kpoint-folding 12 12 12     #Use a Brillouin zone mesh
electronic-SCF              #Perform a Self-Consistent Field optimization
dump-name Si.$VAR
dump End None

elec-n-bands 10             #Si has 4 occupied bands; asking for 6 unoccupied bands
converge-empty-states yes   #Make sure that empty state eigenvalues are reliable

density-of-states Total     #Output total density-of-states
</pre><p> Starting from the total energy calculations of the previous two tutorials, all we needed to do is add the command <a class="el" href="CommandDensityOfStates.html">density-of-states</a>. Additionally, in order to get a few unoccupied states, we ask for more bands using <a class="el" href="CommandElecNbands.html">elec-n-bands</a> and make sure the empty states are converged at the end of the calculation using <a class="el" href="CommandConvergeEmptyStates.html">converge-empty-states</a>. (Note that empty or unoccupied states that don't affect the total energy need not converge at all in a minimize calculation, and may not converge fully in an <a class="el" href="classSCF.html" title="Self-Consistent Field method for converging electronic state.">SCF</a> optimization.) We also cranked up the number of k-points to get smoother results.</p>
<p>Running the above calculation produces a plain text file "Si.dos", which we can straightforwardly plot in gnuplot using the commands (interactively in the gnuplot terminal): </p><pre class="fragment">plot "Si.dos" u 1:2 w l
</pre><p> However, to make things a little more interesting (and show off some gnuplotting!), let's combine this with the band structure from the previous tutorial. Edit the last section of bandstruct.plot (including the edits from the previous tutorial) to be: </p><pre class="fragment">set xzeroaxis               #Add dotted line at zero energy
set ylabel "E - VBM [eV]"   #Add y-axis label
set yrange [*:10]           #Truncate bands very far from VBM
eV = 1/27.2114              #Value of eV in Hartrees
VBM = 0.227557              #VBM value (HOMO from totalE.eigStats)
xEnd = 68                   #Last x-tic value on k-path
set arrow \
  from first xEnd, graph 0 \
    to first xEnd, graph 1  #Draw separator

plot \
  for [i=1:nCols] "bandstruct.eigenvals" binary format=formatString u 0:((column(i)-VBM)/eV) w l, \
  "Si.dos" u (xEnd+0.2*$2):(($1-VBM)/eV) with filledcurves y1=xEnd linecolor rgb "black"
</pre><p> This rotates the density-of-states and aligns its energy with the y-axis of the band structure, producing the plot shown above. Note the correlations between features in the band structure and the density of states. The highest density occurs where there are bands with low curvature, such as the flat section of the lowest bands in the XW segment and the low curvature for the lowest unoccupied bands near Gamma. Can you identify the band gap in the density of states? Correlating it with the band structure, is it a direct or indirect band gap? (That is are the highest occupied and lowest unoccupied states at the same k-point, or different ones?)</p>
<p>Next, let us examine contributions from various orbitals to the density of states. Modify the density-of-states commands in Si.in to: </p><pre class="fragment">density-of-states \
    OrthoOrbital Si 1 s \
    OrthoOrbital Si 1 p
</pre><p> and rerun jdftx on that input file. Here we requested s and p orbital-projected contributions, which will both be saved to columns in the same file Si.dos. Update the final section of the latest version of bandstruct.plot to: </p><pre class="fragment">set key top right outside
plot \
   for [i=1:nCols] "bandstruct.eigenvals" binary format=formatString u 0:((column(i)-VBM)/eV) w l title "", \
   "Si.dos" u (xEnd+0.5*$2):(($1-VBM)/eV) w l lw 2 title "s", \
   "Si.dos" u (xEnd+0.5*$3):(($1-VBM)/eV) w l lw 2 title "p"
</pre><p> and rerun "gnuplot --persist bandstruct.plot" to get the plot shown below. This time, instead of plotting a single total density of states, we plotted the contributions due to the s and p orbitals on the first Si atom. Note that the lower occupied bands exhibit s and p character, while the higher occupied bands have predominantly p character. The unoccupied bands have mixed character, but with a higher p fraction.</p>
<div class="image">
<img src="BandStructDOSprojected.png" alt=""/>
</div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
