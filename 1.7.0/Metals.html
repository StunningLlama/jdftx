<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Metals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Metals.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Metals </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="MetalBandStruct.png" alt=""/>
</div>
<p>Silicon, the crystalline solid we have worked with is a semiconductor with a band gap which we identified in the tutorials on <a class="el" href="BandStructure.html">Band structure calculations</a> and <a class="el" href="DensityOfStates.html">Density of states</a>. This gap clearly demarcates occupied states from unoccupied states for all k-points, so electron 'fillings' are straightforward: the lowest (nElectrons/2) bands of all k-points are filled, and the remaining are empty. This is no longer true for metals, where one or more bands are partially filled, and these fillings (or occupation factors) must be optimized self-consistently. This tutorial introduces such a calculation for platinum.</p>
<p>Platinum is a face-centered cubic metal with a cubic lattice constant of 3.92 Angstroms (7.41 bohrs), which we can specify easily in the input files: </p><pre class="fragment">#Save the following to common.in:
lattice face-centered Cubic 7.41
ion-species GBRV/$ID_pbesol.uspp
elec-ex-corr gga-PBEsol
elec-cutoff 20 100
ion Pt  0 0 0  0      #Single atom per unit cell
</pre><p> and </p><pre class="fragment">#Save the following to totalE.in:
include common.in
dump End ElecDensity State
dump-name totalE.$VAR
kpoint-folding 12 12 12     #Metals need more k-points
elec-smearing Fermi 0.01  #Set fillings using Fermi function at T = 0.01 Hartrees
electronic-SCF
</pre><p> The only new command is <a class="el" href="CommandElecSmearing.html">elec-smearing</a> which specifies that the fillings must be set using a Fermi function based on the current Kohn-Sham eigenvalues, rather than determined once at startup (the default we implicitly used so far). The first parameter of this command specifies the functional form for the occupations, in this case selecting a Fermi function (see <a class="el" href="CommandElecSmearing.html">elec-smearing</a> for other options). The second parameter determines the width in energy over which the Fermi function goes from one to zero (occupied to unoccupied).</p>
<p>Metals are much more sensitive to k-point sampling, because for some bands, a part of the Brillouin zone is filled and the remainder is empty, separated by a Fermi surface. The number of k-points directly determines how accurately the Fermi surface(s) can be resolved. The Fermi temperature is essentially a smoothing parameter that allows us to resolve the Fermi surface accurately at moderate k-point counts. Note that the tempreature we chose is around ten times room temperature in order to increase the smoothing and use a practical number of k-points.</p>
<p>Finally, we have selected the PBEsol exchange-correlation functional using the <a class="el" href="CommandElecExCorr.html">elec-ex-corr</a> command, which is generally more accurate than PBE for solids (especially for metals). Correspondingly, we selected PBEsol pseudopotentials from the GBRV set.</p>
<p>Run the calculation above as usual using </p><pre class="fragment">mpirun -n 4 jdftx -i totalE.in | tee totalE.out
</pre><p> and examine the output file. The main difference is that every SCF line is preceded by a line starting with FillingsUpdate. This line reports the chemical potential, mu, of the Fermi function that produces the correct number of electrons with the current Kohn-Sham eigenvalues, and the number of electrons, nElectrons, which of course stays constant.</p>
<p>Also notice that the energy in the SCF lines is called F instead of Etot. The total energy Etot satisfies a variational theorem at fixed occupations, which we dealt with so far. However, now the occupations equilibrate at a specified temperature T, and the Helmholtz free energy F = E - TS, where S is the electronic entropy, is the appropriate variational free energy to work with. Note the corresponding changes in the energy component printout at the end as well.</p>
<p>Additionally, in the initialization, note that nBands is now larger than nElectrons/2, since the code needs a few empty states to use Fermi fillings. At the end of the calculation, when dumping State, note that the calculation now outputs files with suffix wfns, fillings and Haux. The wfns contain the wavefunctions (Kohn-Sham orbitals) as before, while fillings contains the occupations and Haux contains auxiliary Hamiltonian matrices used by the minimize algorithm with Fermi fillings. When running calculations with Fermi fillings, <a class="el" href="CommandInitialState.html">initial-state</a> will try to read in all these files instead of wfns alone.</p>
<p>Examine the fillings file using: </p><pre class="fragment">binaryToText totalE.fillings 12
</pre><p> The last parameter 12 equals the number of bands, and this causes binaryToText to display the result as a matrix with 12 columns. In this case, the rows then correspond to the reduced k-point (there will be 72 of them). Notice that the first five columns (bands) are approximately 2 (including spin factor) throughout, and columns ten onwards are approximately 0 throughout, whereas columns six through nine have empty, partially occupied and occupied states implying that they cross the Fermi level.</p>
<p>We can also see this in the band structure. Generate bandstruct.kpoints as shown in the <a class="el" href="BandStructure.html">Band structure calculations</a> tutorial, create an input file: </p><pre class="fragment">#Save the following to bandstruct.in
include common.in
include bandstruct.kpoints
fix-electron-density totalE.$VAR
elec-n-bands 12
dump End BandEigs
dump-name bandstruct.$VAR
</pre><p> and run "mpirun -n 4 jdftx -i bandstruct.in". Note that the band structure input file is almost identical to the Si band structure tutorial, varying only in the number of bands. (The band structure calculation should not specify Fermi fillings.) Edit bandstruct.plot to reference the energies relative to mu (from the final FillingsUpdate line, or equivalently using dump End EigStats). and convert to eV (see the end of the <a class="el" href="BandStructure.html">Band structure calculations</a> tutorial). Also update the y-axis range to exclude energies far below the Fermi level (mu), which we have set to zero in the plot and annotated with a dotted line. (Try it without doing so; the three bands you will see far below the Fermi level are inner shell 5p electrons of the platinum which have been treated as valence electrons in the GBRV Pt pseudopotential, which you can check in the pseudopotential section of the initialization log.) Run bandstruct.plot to get the bandstructure shown above. Notice that bands number six - nine from the bottom cross the Fermi level (mu), remembering that three of them are below the bottom margin.</p>
<p>Finally, as an exercise, study the k-point convergence of this metal calculation following the outline of the <a class="el" href="BrillouinZone.html">Brillouin-zone sampling</a> tutorial. How does the k-point convergence of the energy compare to the Silicon case? Try reducing the temperature in elec-fermi-filings from 0.01 to 0.005 and redo the k-point convergence study. Compare the k-point covergence between the two temperatures. Analytically, you expect the number of k-points per dimension to be inversely proportional to the Fermi temperature (smoothing width) in order to keep the accuracy (relative to the true infinite k-points limit) constant. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
