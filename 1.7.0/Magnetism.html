<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Magnetism</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Magnetism.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Magnetism </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="IronDOS.png" alt=""/>
</div>
<p>All our caculations thus far have been for spin-neutral systems, with the exception of the hydrogen atom. This tutorial showcases spin-polarized calculations for crystalline solids using the archetypal example: metallic iron.</p>
<p>Iron has a body-centered cubic structure with a cubic lattice constant of 2.87 Angstroms (5.42 bohrs). Not surprisingly, we can set up an iron calculation using: </p><pre class="fragment">#Save the following to totalE.in:
lattice body-centered Cubic 5.42
ion-species GBRV/$ID_pbesol.uspp
elec-ex-corr gga-PBEsol
elec-cutoff 20 100
ion Fe  0 0 0  0
dump-name totalE.$VAR
dump End ElecDensity
density-of-states Total
kpoint-folding 12 12 12
elec-smearing Fermi 0.01
electronic-SCF

spintype z-spin                  #Allow up/dn spins (non-relativistic)
elec-initial-magnetization 3 no  #Initial guess, no = don't constrain
</pre><p> and run as usual using </p><pre class="fragment">mpirun -n 4 jdftx -i totalE.in | tee totalE.out
</pre><p> Note that the input file is very similar to platinum from the previous tutorial. Of course, we specified body-centered cubic instead of face-centered cubic, updated the lattice constant and the element name. We requested density-of-state and electron density output.</p>
<p>The key difference is the specification of <a class="el" href="CommandSpintype.html">spintype</a> and <a class="el" href="CommandElecInitialMagnetization.html">elec-initial-magnetization</a>, which we previously encountered in the <a class="el" href="OpenShell.html">Open-shell systems</a> tutorial. This time, however, we specified no for the &lt;constrain&gt; parameter for the initial magnetization command, which allows it to be optimized when Fermi fillings are calculated. (Try it with yes and contrast the results!)</p>
<p>Examine the output file. During initialization, 48 symmetries are detected, which reduces the 12<sup>3</sup> = 1728 input kpoints to 72 symmetry-reduced kpoints. However, nStates is now 2 x 72 = 144 due to the explicit treatment of spin.</p>
<p>The FillingsUpdate lines now additionally report magnetic moments of the system: Tot is the net magnetization of the unit cell, whereas Abs is the integral of the absolute value of the magentization density. For ferromagnetic iron, these two are similar, but in an antiferromagnet for example, Tot will be zero while Abs is finite. If both Tot and Abs turned out to be almost zero, it would have meant that the system prefers to be non-magnetic and that allowing for spin polarization (z-spin) should not be necessary. Also note that per atom magnetizations (and charges) are estimated in the Lowdin analysis (printed soon after each IonicMinimize line).</p>
<p>Finally, examine the output files dumped by the code at the end. For ElecDensity, it output n_up and n_dn instead of a single n. Similarly, the density of states for up and dn spins are split between two files totalE.dosUp and totalE.dosDn (instead of totalE.dos).</p>
<p>We can plot the density of states of the two spin channels together using the gnuplot script: </p><pre class="fragment">#!/usr/bin/gnuplot --persist
set xrange [-10:10]
set xlabel "E - Ef [eV]"
mu = 0.6377     #From the final FillingsUpdate line
eV = 1/27.2114
plot \
   "totalE.dosUp" u (($1-mu)/eV):2 w l title "up", \
   "totalE.dosDn" u (($1-mu)/eV):2 w l title "dn" 
</pre><p> as shown at the top of the page.</p>
<p>Note that the up and down spins have very similar shapes in their density of states, but they are offset relative to each other. The up spin channel is lower in energy and hence more of it is below the Fermi level and occupied compared to the down spins: this produces the reported magnetization. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
