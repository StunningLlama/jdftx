<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Two-dimensional materials</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('TwoDmaterials.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Two-dimensional materials </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="GrapheneBandStruct.png" alt=""/>
</div>
<p>The previous sections introduced two classes of geometries specified using the <a class="el" href="CommandCoulombInteraction.html">coulomb-interaction</a> command: isolated systems like molecules which are non-periodic in all three directions, and crystalline solids which are periodic in all three directions. This section explores systems which are periodic in two directions and non-periodic in one direction, which is specified using </p><pre class="fragment">coulomb-interaction Slab 001
</pre><p> where the second parameter specifies which direction is periodic. (Similarly, "coulomb-interaction Wire 001" specifies a geometry which is periodic only along the third direction, which is useful for systems such as nanowires, nanotubes and DNA.)</p>
<p>The slab geometry, as the name suggests, is useful for treating slabs of material surrounded by empty space or solvent on two sides, which in turn is usually meant to describe the properties of the surface of a solid (solid-vacuum interface) or a solid-liquid interface.</p>
<p>First, we'll take an extreme example which is all surface: graphene. We will setup the geometry by peeling out a single layer of graphite from the <a class="el" href="Dispersion.html">Dispersion (vdW) corrections</a> tutorial: </p><pre class="fragment">#Save the following to common.in:
coulomb-interaction Slab 001
coulomb-truncation-embed 0 0 0
lattice Hexagonal 4.651 15           #Exact vertical dimension no longer matters

ion C  0.000000  0.000000  0.0   0
ion C  0.333333 -0.333333  0.0   0

ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
</pre><p> We will then perform total energy and band structure calculations as usual using the input files: </p><pre class="fragment">#Save the following to totalE.in:
include common.in
kpoint-folding 12 12 1               #Need k-points only in periodic directions
elec-smearing Fermi 0.01
dump-name totalE.$VAR
dump End ElecDensity


#Save the following to bandstruct.in:
include common.in
include bandstruct.kpoints
fix-electron-density totalE.$VAR
elec-n-bands 8
dump-name bandstruct.$VAR
dump End BandEigs


#Save the following to bandstruct.kpoints.in:
kpoint 0.00000  0.00000  0.0     Gamma
kpoint 0.50000  0.00000  0.0     M
kpoint 0.66667 -0.33333  0.0     K
kpoint 0.00000  0.00000  0.0     Gamma
</pre><p> and the commands: </p><pre class="fragment">bandstructKpoints bandstruct.kpoints.in 0.02 bandstruct  #Generate bandstruct.kpoints and bandstruct.plot
mpirun -n 4 jdftx -i totalE.in | tee totalE.out          #Run total energy calculation
mpirun -n 4 jdftx -i bandstruct.in                       #Run bandstructure calculation
gnuplot --persist bandstruct.plot                        #Plot band structure
</pre><p> Edit the bandstructure plot to reference the enegies against the Fermi level (mu from final FillingsUpdate line) and convert it to eV, to get the band structure shown above. Note the Dirac point seen at the K point as the intersection of two bands exactly at the Fermi level.</p>
<p>Next, examine the effect of the Coulomb truncation on the energy levels of the system. For a neutral slab (or 2D material) in vacuum, the electrostatic potential exponentially decays away from the surface(s). With Coulomb truncation in Slab mode, this property is reproduced even in the plane-wave basis, whereas without it, the potential has an undetermined offset as in the 3D periodic (bulk solid) case. Repeat the total-energy calculation above for increasing lengths of the unit cell, both with and without the two Coulomb truncation lines, and note the final mu in each case. (This could be easily automated using variable substitution as in the <a class="el" href="CoulombTrunc.html">Setting up molecule geometries</a> tutorial.)</p>
<p>This mu is the chemical potential or Fermi level of electrons relative to zero potential at infinity, and therefore corresponds to the work function of the material. For graphene, testing the convergence of mu (in Hartrees) with respect to cell length Lz (in bohrs) yields:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Lz   </th><th class="markdownTableHeadNone">mu with truncation   </th><th class="markdownTableHeadNone">mu without truncation    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">15   </td><td class="markdownTableBodyNone">-0.155825   </td><td class="markdownTableBodyNone">+0.019651    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">20   </td><td class="markdownTableBodyNone">-0.156102   </td><td class="markdownTableBodyNone">-0.024394    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">25   </td><td class="markdownTableBodyNone">-0.156106   </td><td class="markdownTableBodyNone">-0.050738    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">30   </td><td class="markdownTableBodyNone">-0.156103   </td><td class="markdownTableBodyNone">-0.068295   </td></tr>
</table>
<p>As expected, mu converges exponentially with cell size with truncation, but very slowly (with an error inversely proportional to cell volume) without truncation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
