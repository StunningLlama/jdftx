<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: DFT + U</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('DFTplusU.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">DFT + U </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="IronOxideDOS.png" alt=""/>
</div>
<p>Now we move on from a ferromagnetic metal to an antiferromagnetic insulator, ferrous oxide (FeO). This tutorial introduces DFT + U, a technique to compensate for errors in density-functional theory for localized electrons (such as d and f electrons).</p>
<p>Ferrous oxide has a rock-salt structure which consists of two inter-penetrating face-centered cubic lattices of iron and oxygen atoms, with cubic lattice contant 4.32 Angstroms (8.16 bohrs) each. We could set up that geometry using: </p><pre class="fragment">lattice face-centered Cubic 8.16
ion Fe 0.0 0.0 0.0  0
ion O  0.5 0.5 0.5  0
</pre><p> However, that geometry contains only one Fe atom per unit cell, which would then constrain every Fe atom in our structure to have the same magnetic moment, resulting in a ferromagnetic structure. We need a minimum of two Fe atoms in the unit cell to obtain an antiferromagnetic structure, so we could construct one possible antiferromagnetic structure by doubling up the unit cell: </p><pre class="fragment">#Save the following to FeO.in:
lattice face-centered Cubic 8.16
latt-scale 1 1 2.01             #Slightly break symmetry
kpoint-folding 6 6 3

ion Fe 0.0 0.0 0.00  0
ion Fe 0.0 0.0 0.50  0
ion O  0.5 0.5 0.25  0
ion O  0.5 0.5 0.75  0

ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
elec-smearing Fermi 0.01
electronic-SCF

spintype z-spin
initial-magnetic-moments Fe +5 -5

dump End None
density-of-states Total
dump-name PBE.$VAR
</pre><p> Note that we used <a class="el" href="CommandLattScale.html">latt-scale</a> to double the last lattice vector. Once we make the system antiferromagnetic, we will break the rotational symmetry between the first two and the third lattice directions. We make the third direction sightly different from exactly twice as long so that the system does not get constrained artifically by symmetries; in real calculations we would then optimize the lattice to find the equilibrium geometry and distortions (if any), but I skip it above to make the calculations quicker. Note that we correspondingly halved the last fractional coordinate of each atom, and repeated them once with an offset of 0.5 along the last direction. We also reduced the kpoint folding by half along that direction, since the unit cell is longer to start with in that direction.</p>
<p>The remaining setup is similar to the iron calculation in the <a class="el" href="Magnetism.html">Magnetism</a> tutorial, except that instead of specifying a guess for the total magnetization of the unit cell using <a class="el" href="CommandElecInitialMagnetization.html">elec-initial-magnetization</a> (which would be zero for an antiferromagnet), we specify guesses for each Fe atom individually using <a class="el" href="CommandInitialMagneticMoments.html">initial-magnetic-moments</a>. Specifically, we set the initial magnetization to be equal and opposite for the two atoms in the unit cell.</p>
<p>Run this calculation as usual using: </p><pre class="fragment">mpirun -n 4 jdftx -i FeO.in | tee PBE.out
</pre><p> and examine the output file. This time, the FillingsUpdate lines report a total magnetization close to zero, but an absolute magnetization far from zero due to the equal and opposite magnetic moments. Additionally the absolute magnetization is 7.1, which lines up well with the absolute sum of per-atom magnetic moments estimated in the Lowdin analysis, +3.5 and -3.5. (Note that these need not line up exactly; per-atom magnetic moments do not have an unambiguous physical definition, and Lowdin analysis only provides estimates.)</p>
<p>Plot the up and dn spin density of states with energy relative to the Fermi level, following the previous tutorial. Note that both spin channels now have the same density of states profile because there are equal number of up and dn spins per unit cell. As an exercise, examine the orbital-projected density of states on the two Fe atoms; there should be a difference between the majority and minority spin channels on each atom. Note however, that the density of states at the Fermi level is finite, indicating that the structure is metallic, rather than insulating as expected.</p>
<p>The reason for this discrepancy is self-interaction errors for localized electrons in DFT. The d electrons in particular experience an unphysical <a class="el" href="classCoulomb.html" title="Abstract base class for the (optionally truncated) Coulomb interaction.">Coulomb</a> repulsion with themselves, which increases their energy and in this case, the occupied d bands cross the Fermi level rather than remaining entirely below it, thereby making the material metallic. DFT + U is a simple way to correct this issue by adding an energy correction depending on the occupation of localized states using atomic orbital projections. This however introduces a parameter U that could be calculated using perturbation theory, or calibrated to experimental properties of interest such as band gaps or formation energies. For Fe, a typical value of this parameter is 4.3 eV = 0.158 Hartrees, and we include this in the input file FeO.in by adding the command <a class="el" href="CommandAddU.html">add-U</a> : </p><pre class="fragment">add-U Fe d 0.158
</pre><p> which specifies the correction just for d orbitals of species Fe. Also, update the dump-name to PBE+U.$VAR so as to not replace previous outputs, and run "mpirun -n 4 jdftx -i FeO.in | tee PBE+U.out". Note that the magentic moments are larger after adding U because it makes it more favorable for electrons to occupy the high-spin localized orbitals. Additionally, plotting the density of states reveals that the U correction indeed opens up a gap (by pushing down occupied d orbitals in energy relative to unoccupied d orbitals), as shown at the top of the page.</p>
<p>Exercise: examine the electronic band structure: is the band gap direct or indirect? </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
