<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Free energy: Vibrations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('FreeEnergy.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Free energy: <a class="el" href="classVibrations.html" title="Vibrational modes and free energy calculator.">Vibrations</a> </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="H2.png" alt=""/>
</div>
<p>The energies calculated so far have been at a specific set of atom coordinates, whether specificied manually or optimized. These energies correspond to the Born-Oppenheimer surface, and do not include (free-)energy components due to the ionic degrees of freedom. This tutorial introduces the vibrations post-processing module with the example of the binding (free-)energy of the hydrogen molecule.</p>
<p>Start by setting up a hydrogen molecule calculation with H2.ionpos: </p><pre class="fragment"> ion H 0 0 +0.7  1
 ion H 0 0 -0.7  1
</pre><p> and a split input file to reuse commands between two calculations. Save the following to common.in: </p><pre class="fragment">lattice Cubic 15
include H2.ionpos
coords-type Cartesian
core-overlap-check None  #GBRV H psp core radius &gt; H2 bond length/2

coulomb-interaction Isolated
coulomb-truncation-embed 0 0 0

ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
</pre><p> and the following to totalE.in (for our total enegy calculation): </p><pre class="fragment">include common.in
ionic-minimize nIterations 10   #Geometry optimization
dump End State
dump-name H2.$VAR
</pre><p> Run jdftx on totalE.in to optimize the molecule geometry (replaces H2.ionpos) and get the converged wavefunctions in H2.wfns.</p>
<p>Note that in this case we needed to specify an extra command <a class="el" href="CommandCoreOverlapCheck.html">core-overlap-check</a> to tell JDFTx that it is okay that the H pseudopotential core radii overlap; otherwise the code will fail with an error specifying that the atoms are too close. In general, this should not be required as the pseudopotential cores should not substantially overlap in bonded geometries; the H2 molecule and this H pseudopotential are a somewhat rare exception.</p>
<p>With the GBRV pseudopotentials, the final energy is -1.1651 Hartrees, and we can calculate the Born-Oppenheimer binding energy using the Hydrogen atom calculation from the <a href="OpenShell.html">previous tutorial</a> as E_H2 - 2EH = -1.1651 - 2(-0.4999) = -0.1653 Hartrees = -4.498 eV. However, this binding energy doesn't yet include the ionic (nuclear) contributions and is not yet meaningfully comparable to the experimental results.</p>
<p>Now, calculate the vibrational contributions by running jdftx on the input file: </p><pre class="fragment">include common.in
initial-state H2.$VAR
dump End None
vibrations \
    dr 0.01 \
    centralDiff yes \
    translationSym yes \
    rotationSym yes \
    T 298
</pre><p> The <a class="el" href="CommandVibrations.html">vibrations</a> command calculates the normal modes of vibration by perturbing each atom by displacements of magnitude dr and constructs the force matrix optionally using a central-difference derivative formula (controlled by centralDiff). The translationSym and rotationSym commands control whether translation and rotational symmetries are used to constrain and optimize the force matrix calculations. (These symmetries should be used for molecular calcuations, but should not be used for solid or surface calculations.) T specifies the temperature for vibrational free energy calculation.</p>
<p>Now examine the generated output file. Notice that electronic minimization is performed for several perturbed configurations, and then normal modes obtained by diagonalizing the force matrix are reported. In this case, of the six degrees of freedom due to two hydrogen nuclei positions, five normal modes are zero (three translational and two rotational), and one normal mode, the H-H stretch, has a finite vibrational frequency of about 0.020 Hartrees.</p>
<p>Finally the output file reports the vibrational free energy components including the zero-point energy (ZPE), the vibrational energy including ZPE (Evib), the vibrational entropy (TSvib) and the net vibrational free energy (Avib). We can now calculate the correct zero-temperature binding energy as </p><pre class="fragment">    E_H2 + ZPE_H2 - 2EH
 = -1.1651 + 0.00997 - 2(-0.4999)
 = -0.1553 Hartrees
 = -4.227 eV,
</pre><p> where E's are the final energies obtained from the total energy calculations for H2 (above) and H (previous tutorial), and ZPE is the zero-point energy obtained at the end of the H2 vibration calculation.</p>
<p>At room temperature, the correct binding free energy is </p><pre class="fragment">   E_H2 + Avib_H2 + (3/2)kT - 2(EH + (3/2)kT)
 = -1.1651 + 0.00997 + 1.5*0.00094 - 2(-0.4999 + 1.5*0.00094)
 = -0.1567 Hartrees
 = -4.265 eV,
</pre><p> where Avib is the vibrational free energy from the end of the H2 vibration calculation (instead of ZPE used above) and the (3/2)kT contributions correspond to the ideal-gas translational free energies. In comparison, the experimental binding energy (negative of atomization energies) from <a href="http://cccbdb.nist.gov">CCCBDB</a> is 4.48 eV at zero temperature and at 4.52 eV at room temperature. The PBE GGA predictions have an error of approximately 0.2 eV for the binding energies; note that these calculations agree well with the PBE-calculated atomization energy on CCCBDB.</p>
<p>Exercise: check that the hybrid functionals (eg. PBE0) predict the binding energy of H2 in better agreement with experiment. Remember that you will need to use the norm-conserving SG15 pseudopotentials. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
