<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>JDFTx: Dispersion (vdW) corrections</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="jdftx-55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">JDFTx
   &#160;<span id="projectnumber">1.7.0</span>
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('Dispersion.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Dispersion (vdW) corrections </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div class="image">
<img src="Graphite.png" alt=""/>
</div>
<p>The solids discussed so far are bound together by strong bonds: covalent bonds in silicon, metallic bonds in platinum and iron, and covalent/ionic bonds in iron oxide. Density-functional theory is reasonably accurate for predicting the lattice and ionic geometries of such materials, but misses the weaker van der Waals (vdW) or dispersion interactions caused by long-range correlations of electron fluctuations. This tutorial illustrates this issue in graphite, and shows how to mitigate it using the DFT+D2 vdW correction.</p>
<p>Graphite consists of layers of hexagonal carbon networks (graphene) with weak interlayer binding from van der Waals interactions. The two-dimensional unit cell for one hexagonal layer contains two carbon atoms. The layers alternate with one atom in line with those of neighbouring layers, and the other over the hexagonal voids of neighbouring layers. Vertically, a unit cell therefore includes two layers, with a total of four carbon atoms. Experimentally, the hexagonal lattice constants are a = 2.461 Angstroms (4.651 bohrs) and c = 6.708 Angstroms (12.676 bohrs), which correspond to in-plane carbon-carbon bond lengths of a/sqrt(3) = 1.42 Angstroms and interlayer spacing of c/2 = 3.35 Angstroms. We can setup a unit cell with the experimental geometry as: </p><pre class="fragment">#Save the following to graphite.lattice:
lattice Hexagonal 4.651 12.676


#Save the following to graphite.in:
include graphite.lattice
ion C  0.000000  0.000000  0.0   0
ion C  0.333333 -0.333333  0.0   0
ion C  0.000000  0.000000  0.5   0
ion C -0.333333  0.333333  0.5   0

ion-species GBRV/$ID_pbe.uspp
elec-cutoff 20 100
kpoint-folding 12 12 4

elec-smearing Fermi 0.01
electronic-SCF
lattice-minimize nIterations 10
dump End Lattice
dump-name graphite.$VAR
</pre><p> and optimize the lattice geometry using: </p><pre class="fragment">mpirun -n 4 jdftx -i graphite.in | tee graphite.out
mpirun -n 4 jdftx -i graphite.in | tee -a graphite.out
</pre><p> (continuing the calculation at least once to minimize basis-set errors as discussed in the <a class="el" href="LatticeOpt.html">Lattice optimization</a> tutorial).</p>
<p>Check the final converged lattice constants: the in-plane directions expand by about 0.2% indicating that DFT is quite accurate for the strong covalent C-C bond lengths. However, the vertical direction expands by over 20% indicating that DFT severely underestimates the interlayer vdW interactions.</p>
<p>We can compensate for the missing vdW interactions using Grimme's DFT+D2 method which adds a pair-potential term using atomic polarizabilities with an empirical scale factor fit to the geometries of several vdW complexes. To use this in the code, add the command </p><pre class="fragment">van-der-waals
</pre><p> to the input file and rerun JDFTx a couple of times. Note that you start out at the previously-converged expanded unit cell (unless you reset grahite.lattice manually). After converging with these vdW corrections, the in-plane lattice constant is within 0.1% of the experimental value and the vertical lattice constant is approximately 5% smaller than experiment. Therefore, with the corrections, this DFT+D2 approach slightly overestimates the strength of the interlayer vdW interactions in graphene, but overall performs much better in absolute error than with no correction.</p>
<p>If highly accurate geometries are desired for a particular class of vdW-bound materials, it is possible to adjust either the overall scale factor using the <a class="el" href="CommandVanDerWaals.html">van-der-waals</a> command, or using the individual atom polarizabilities using the <a class="el" href="CommandSetVDW.html">setVDW</a> command. See the "Initializing van der Waals corrections" section of the output file to find the default values of C6 coefficients used for the atoms.</p>
<p>Exercises: find the optimum vdW scale factor for graphite using the default C6, and similarly find the optimum C6 using the default scale factor. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
</div>
</body>
</html>
